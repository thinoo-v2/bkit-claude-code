# v1.4.7-docs-sync Plan Document

> **Feature**: v1.4.7-docs-sync
> **Version**: 1.4.7
> **Date**: 2026-01-29
> **Author**: Claude Opus 4.5
> **PDCA Phase**: Plan

---

## 1. Executive Summary

bkit v1.4.7에서 완료된 **두 가지 핵심 기능**의 문서화 및 버전 동기화 작업입니다.

### 완료된 기능

| Feature | Description | Match Rate |
|---------|-------------|:----------:|
| **task-bkit-integration** | Task Management + PDCA 워크플로우 완전 통합 | 100% |
| **bkit-core-modularization** | lib/common.js 모듈화 (4개 디렉토리, 22개 파일) | 100% |

### 작업 목표

1. 모든 버전 참조를 1.4.6 → 1.4.7로 업데이트
2. CHANGELOG.md에 v1.4.7 변경사항 추가
3. README.md에 새 기능 설명 추가
4. CUSTOMIZATION-GUIDE.md에 모듈화 내용 반영
5. 기타 설정 파일 버전 동기화

---

## 2. Background & Context

### 2.1 완료된 기능 상세

#### Feature 1: task-bkit-integration

**목적**: Claude Code Task Management System과 PDCA 워크플로우의 완전한 통합

**주요 구현 내용**:
- Task Chain Auto-Creation: `/pdca plan` 시 Plan→Design→Do→Check→Report Task 체인 자동 생성
- Task ID Persistence: 세션 간 Task ID 영속성 확보 (.pdca-status.json)
- Check↔Act Iteration: matchRate < 90% 시 자동 개선 사이클 (최대 5회)
- Full-Auto Mode: 완전 자동화 모드 지원 (manual/semi-auto/full-auto)

**새 함수** (lib/common.js → lib/task/):
- `savePdcaTaskId()` - Task ID 영속 저장
- `getPdcaTaskId()` - Task ID 조회
- `createPdcaTaskChain()` - PDCA Task 체인 생성
- `getTaskChainStatus()` - Task 체인 상태 조회
- `triggerNextPdcaAction()` - 다음 PDCA 액션 트리거
- `getAutomationLevel()` - 자동화 레벨 조회
- `isFullAutoMode()` - Full-Auto 모드 확인
- `shouldAutoAdvance()` - 자동 진행 여부 확인
- `generateAutoTrigger()` - 자동 트리거 생성

**수정된 파일**:
- `lib/common.js` (+500 lines, 9 functions)
- `scripts/pdca-skill-stop.js` (+50 lines)
- `scripts/gap-detector-stop.js` (+30 lines)
- `scripts/iterator-stop.js` (+20 lines)

#### Feature 2: bkit-core-modularization

**목적**: lib/common.js (3,722줄, 110+ 함수)를 4개 JavaScript 모듈로 분리

**모듈 구조**:
```
lib/
├── common.js              # Migration Bridge (212 lines)
├── common.js.backup       # Original backup (3,722 lines)
├── core/                  # Core utilities (7 files, 37 exports)
│   ├── index.js
│   ├── platform.js
│   ├── cache.js
│   ├── debug.js
│   ├── config.js
│   ├── io.js
│   └── file.js
├── pdca/                  # PDCA management (6 files, 50 exports)
│   ├── index.js
│   ├── tier.js
│   ├── level.js
│   ├── phase.js
│   ├── status.js
│   └── automation.js
├── intent/                # Intent analysis (4 files, 19 exports)
│   ├── index.js
│   ├── language.js
│   ├── trigger.js
│   └── ambiguity.js
└── task/                  # Task management (5 files, 26 exports)
    ├── index.js
    ├── classification.js
    ├── context.js
    ├── creator.js
    └── tracker.js
```

**주요 특징**:
- 132개 함수 export
- 순환 의존성 Zero (Lazy Require Pattern)
- 100% 하위 호환성 (Migration Bridge)
- 22개 새 모듈 파일

---

## 3. Requirements

### 3.1 Version Update (P0)

| ID | File | Current | Target | Priority |
|----|------|:-------:|:------:|:--------:|
| VU-01 | `.claude-plugin/plugin.json` | 1.4.6 | 1.4.7 | P0 |
| VU-02 | `bkit.config.json` | 1.4.6 | 1.4.7 | P0 |
| VU-03 | `gemini-extension.json` | 1.4.6 | 1.4.7 | P0 |
| VU-04 | `hooks/session-start.js` | v1.4.6 | v1.4.7 | P0 |

### 3.2 Documentation Update (P0)

| ID | File | Changes | Priority |
|----|------|---------|:--------:|
| DU-01 | `CHANGELOG.md` | Add v1.4.7 section with both features | P0 |
| DU-02 | `README.md` | Update version badge, add feature highlights | P0 |
| DU-03 | `CUSTOMIZATION-GUIDE.md` | Add modularization info, new import paths | P1 |
| DU-04 | `GEMINI.md` | Update version reference if present | P1 |

### 3.3 bkit-system Updates (P1)

| ID | File | Changes | Priority |
|----|------|---------|:--------:|
| BS-01 | `bkit-system/README.md` | Update lib structure docs | P1 |
| BS-02 | `bkit-system/lib/` | Update function references | P1 |

---

## 4. Task Chain

```
┌─────────────────────────────────────────────────────────────┐
│ [Plan] v1.4.7-docs-sync                          ← Current │
│   ↓                                                         │
│ [Design] v1.4.7-docs-sync                                   │
│   ↓                                                         │
│ [Do] v1.4.7-docs-sync                                       │
│   ├── Task 1: Version files update (4 files)               │
│   ├── Task 2: CHANGELOG.md update                          │
│   ├── Task 3: README.md update                             │
│   ├── Task 4: CUSTOMIZATION-GUIDE.md update                │
│   └── Task 5: bkit-system docs update                      │
│   ↓                                                         │
│ [Check] v1.4.7-docs-sync                                    │
│   ↓                                                         │
│ [Report] v1.4.7-docs-sync                                   │
└─────────────────────────────────────────────────────────────┘
```

---

## 5. Implementation Order

### Phase 1: Version Files Update (P0)

1. **plugin.json** - `"version": "1.4.6"` → `"version": "1.4.7"`
2. **bkit.config.json** - `"version": "1.4.6"` → `"version": "1.4.7"`
3. **gemini-extension.json** - `"version": "1.4.6"` → `"version": "1.4.7"`
4. **session-start.js** - Header comment `(v1.4.6)` → `(v1.4.7)`

### Phase 2: CHANGELOG.md Update (P0)

v1.4.7 섹션 추가:

```markdown
## [1.4.7] - 2026-01-29

### Added
- **Task Management + PDCA Integration**: Complete integration of Claude Code Task System
  - Task Chain Auto-Creation on `/pdca plan`
  - Task ID Persistence in `.pdca-status.json`
  - Check↔Act Iteration (max 5 iterations, 90% threshold)
  - Full-Auto Mode (manual/semi-auto/full-auto)
  - 9 new functions: `savePdcaTaskId`, `createPdcaTaskChain`, `triggerNextPdcaAction`, etc.
- **Core Modularization**: lib/common.js split into 4 module directories
  - `lib/core/` - Platform detection, caching, debugging, configuration (7 files)
  - `lib/pdca/` - PDCA phase management, status tracking (6 files)
  - `lib/intent/` - Intent analysis, language detection, triggers (4 files)
  - `lib/task/` - Task classification, creation, tracking (5 files)
  - 22 new module files, 132 function exports
  - Migration Bridge for 100% backward compatibility
  - Lazy Require Pattern for circular dependency prevention

### Changed
- **lib/common.js**: Converted to Migration Bridge (3,722 → 212 lines)
- **scripts/pdca-skill-stop.js**: Task chain creation integration
- **scripts/gap-detector-stop.js**: triggerNextPdcaAction integration
- **scripts/iterator-stop.js**: triggerNextPdcaAction integration

### Compatibility
- **Claude Code**: Minimum v2.1.15, Recommended v2.1.22
- **Gemini CLI**: Minimum v0.25.0
- **Node.js**: Minimum v18.0.0
```

### Phase 3: README.md Update (P1)

- Version badge update
- Add v1.4.7 feature highlights
- Update lib structure description

### Phase 4: CUSTOMIZATION-GUIDE.md Update (P1)

- Add module import paths documentation
- Update lib structure section
- Add migration guidance for existing users

### Phase 5: bkit-system Docs Update (P2)

- Update lib/ structure documentation
- Add module architecture diagram

---

## 6. Verification Checklist

| ID | Check Item | Method |
|----|------------|--------|
| VC-01 | All version references updated to 1.4.7 | grep "1.4.6" |
| VC-02 | CHANGELOG.md has v1.4.7 section | File review |
| VC-03 | README.md version badge correct | File review |
| VC-04 | No broken imports after modularization | Node.js require test |
| VC-05 | session-start.js loads successfully | Hook test |

---

## 7. Risk Assessment

| Risk | Impact | Mitigation |
|------|:------:|------------|
| Missed version reference | Low | Use grep to find all 1.4.6 references |
| Module import failure | Medium | Test all imports before commit |
| CHANGELOG formatting error | Low | Follow existing format pattern |

---

## 8. Timeline

| Phase | Duration | Tasks |
|-------|:--------:|-------|
| Plan | 30 min | This document (DONE) |
| Do | 60 min | All file updates |
| Check | 15 min | Verification |
| Report | 15 min | Completion report |

**Total Estimated**: 2 hours

---

## 9. Dependencies

- Completed: task-bkit-integration (100% match rate)
- Completed: bkit-core-modularization (100% match rate)
- No external dependencies

---

## 10. Appendix

### A. Files to Update Summary

```
Priority P0 (Must):
├── .claude-plugin/plugin.json
├── bkit.config.json
├── gemini-extension.json
├── hooks/session-start.js
└── CHANGELOG.md

Priority P1 (Should):
├── README.md
├── CUSTOMIZATION-GUIDE.md
└── GEMINI.md

Priority P2 (Could):
└── bkit-system/README.md
```

### B. Version Grep Command

```bash
grep -r "1.4.6" --include="*.json" --include="*.js" --include="*.md" .
```

---

*Generated by bkit PDCA Plan Phase*
*Date: 2026-01-29*
